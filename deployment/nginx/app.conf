server {
    listen 3000;
    root /usr/share/nginx/html;
    index index.html;
    absolute_redirect off;

    # HTML: always check for updates
    location ~* \.html$ {
        add_header Cache-Control "no-cache";
    }

    # CSS/JS/images/fonts: ETag-based validation cache
    location ~* \.(css|js|jpg|jpeg|png|gif|svg|woff2|woff|ttf|ico)$ {
        add_header Cache-Control "public, must-revalidate";
        etag on;
    }

    # JSON config: always fresh
    location = /config.json {
        add_header Cache-Control "no-cache";
    }

    # Google Docs URL pattern â†’ auto-upload redirect
    location /document/d/ {
        rewrite ^/document/d/([^/]+) /dashboard/upload.html?doc=$1 redirect;
    }

    location / {
        try_files $uri $uri/ =404;
    }
}
